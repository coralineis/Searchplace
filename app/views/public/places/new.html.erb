<div class="container">
  <div class="row justify-content-center">
    <h3 class="bg-light">Place新規登録</h3>
  </div>

  <%= form_with model: @place, url: confirm_places_path, method: :post do |f| %>
    <table class="table table-borderless">
      <tbody>
        <tr>
          <th><%= f.label :place_genre_id, "ジャンル" %></th>
          <th>
            <%= f.select :place_genre_id, options_from_collection_for_select(PlaceGenre.all, :id, :name), :prompt => "--ジャンルを選択してください--" %>
          </th>
        </tr>
        <tr>
          <th><%= f.label :image, "画像" %></th>
          <th>
            <%= f.file_field :image %>
            <%= f.hidden_field :image_cache %>
          </th>
        </tr>
        <tr>
          <th><%= f.label :name, "施設名称" %></th>
          <th><%= f.text_field :name %></th>
        </tr>
        <tr>
          <th><%= f.label :introduction, "感想　おすすめポイント" %></th>
          <th><%= f.text_area :introduction %></th>
        </tr>
        <tr>
          <th><%= f.label :tag_list, "タグを追加" %></th>
          <th>
            <%= f.text_field :tag_list, value: @place.tag_list.join(',') %>
            <%= f.hidden_field :tag_list %>
          </th>
        </tr>
        <tr>
          <th><%= f.label :time, "所要時間" %></th>
          <th><%= f.text_field :time %>時間</th>
        </tr>
        <tr>
          <%= f.fields_for :spot do |s| %>
          <th><%=  %></th>

<div id="display"></div>
<input id="address" type="textbox" value="GeekSalon">
<input type="button" value="Encode" onclick="codeAddress()">
            <div id='map'></div>
            <style>
            #map {
              height: 400px;
              width: 400px;
            }
            </style>
            <script>
            let map
            function initMap(){
              geocoder = new google.maps.Geocoder()
              map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: 35.6809591, lng: 139.7673068},
                zoom: 12,
              });
              marker = new google.maps.Marker({
                position:  {lat: 35.6809591, lng: 139.7673068},
                map: map
              });
            }
            let geocoder
            const display = document.getElementById('display')
            function codeAddress(){
              let inputAddress = document.getElementById('address').value;
              geocoder.geocode( { 'address': inputAddress}, function(results, status) {
                if (status == 'OK') {
                  map.setCenter(results[0].geometry.location);
                  var marker = new google.maps.Marker({
                      map: map,
                      position: results[0].geometry.location
                  });
                  display.textContent = "検索結果：" + results[ 0 ].geometry.location
                } else {
                  alert('該当する結果がありませんでした：' + status);
                }
              });
            }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['API_KEY'] %>&callback=initMap" async defer></script>
        </tr>
        <tr>
          <th></th>
          <th><%= f.submit "投稿イメージを確認する", class: "btn btn-success" %></th>
        </tr>
      </tbody>
    </table>
  <% end %>
</div>